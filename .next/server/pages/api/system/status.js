"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/system/status";
exports.ids = ["pages/api/system/status"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsystem%2Fstatus&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csystem%5Cstatus.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsystem%2Fstatus&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csystem%5Cstatus.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\system\\status.ts */ \"(api)/./src/pages/api/system/status.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/system/status\",\n        pathname: \"/api/system/status\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_system_status_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnN5c3RlbSUyRnN0YXR1cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyU1Q3BhZ2VzJTVDYXBpJTVDc3lzdGVtJTVDc3RhdHVzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ2lFO0FBQ2pFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyw0REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsNERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnQtcmVjaXBlLWdlbmVyYXRvci1sb2NhbC8/MjAxYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjXFxcXHBhZ2VzXFxcXGFwaVxcXFxzeXN0ZW1cXFxcc3RhdHVzLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3lzdGVtL3N0YXR1c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N5c3RlbS9zdGF0dXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsystem%2Fstatus&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csystem%5Cstatus.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/lib/lmstudio.ts":
/*!*****************************!*\
  !*** ./src/lib/lmstudio.ts ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkLMStudioHealth: () => (/* binding */ checkLMStudioHealth),\n/* harmony export */   generateChatResponse: () => (/* binding */ generateChatResponse),\n/* harmony export */   generateRecipe: () => (/* binding */ generateRecipe),\n/* harmony export */   generateRecipeTags: () => (/* binding */ generateRecipeTags),\n/* harmony export */   getAvailableModels: () => (/* binding */ getAvailableModels),\n/* harmony export */   getTTS: () => (/* binding */ getTTS),\n/* harmony export */   validateIngredient: () => (/* binding */ validateIngredient)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./prisma */ \"(api)/./src/lib/prisma.ts\");\n/* harmony import */ var _prompts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./prompts */ \"(api)/./src/lib/prompts.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__]);\nopenai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// LM Studio configuration\nconst LM_STUDIO_BASE_URL = \"https://hahahagame-gemini-play.deno.dev\";\nconst LM_STUDIO_API_KEY = process.env.LM_STUDIO_API_KEY;\n// Initialize OpenAI client configured for LM Studio\nconst lmStudio = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    baseURL: LM_STUDIO_BASE_URL,\n    apiKey: LM_STUDIO_API_KEY\n});\nconst saveLMStudioResponses = async ({ userId, prompt, response, model })=>{\n    try {\n        const aiGenerated = await _prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].aIGenerated.create({\n            data: {\n                userId,\n                prompt,\n                response,\n                model: model || \"gemini-2.0-flash\",\n                tokens: response.usage?.total_tokens || 0,\n                cost: 0,\n                status: \"success\"\n            }\n        });\n        return aiGenerated.id;\n    } catch (error) {\n        console.error(\"Failed to save LM Studio response to db:\", error);\n        return null;\n    }\n};\n// Generate recipes using LM Studio\nconst generateRecipe = async (ingredients, dietaryPreferences, userId)=>{\n    try {\n        const prompt = (0,_prompts__WEBPACK_IMPORTED_MODULE_2__.getRecipeGenerationPrompt)(ingredients, dietaryPreferences);\n        const model = \"gemini-2.0-flash\";\n        console.info(\"Generating recipes from LM Studio...\");\n        const response = await lmStudio.chat.completions.create({\n            model,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 2000,\n            temperature: 0.7,\n            top_p: 0.9\n        });\n        console.log(\"LM Studio response received successfully\");\n        const _id = await saveLMStudioResponses({\n            userId,\n            prompt,\n            response,\n            model\n        });\n        return {\n            recipes: response.choices[0].message?.content,\n            openaiPromptId: _id || \"null-prompt-id\"\n        };\n    } catch (error) {\n        console.error(\"Failed to generate recipe with LM Studio:\", error);\n        if (error instanceof Error) {\n            console.error(\"Error message:\", error.message);\n            console.error(\"Error stack:\", error.stack);\n        }\n        // Re-throw with more specific error information\n        throw new Error(`LM Studio Error: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n    }\n};\n// Validate an ingredient name using LM Studio\nconst validateIngredient = async (ingredientName, userId)=>{\n    try {\n        const prompt = (0,_prompts__WEBPACK_IMPORTED_MODULE_2__.getIngredientValidationPrompt)(ingredientName);\n        const model = \"gemini-2.0-flash\";\n        console.info(\"Validating ingredient with LM Studio...\");\n        const response = await lmStudio.chat.completions.create({\n            model,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 500,\n            temperature: 0.3\n        });\n        await saveLMStudioResponses({\n            userId,\n            prompt,\n            response,\n            model\n        });\n        return response.choices[0].message?.content;\n    } catch (error) {\n        console.error(\"Failed to validate ingredient with LM Studio:\", error);\n        throw new Error(\"Failed to validate ingredient\");\n    }\n};\n// Get recipe narration text using LM Studio\nconst getRecipeNarration = async (recipe, userId)=>{\n    try {\n        const prompt = (0,_prompts__WEBPACK_IMPORTED_MODULE_2__.getRecipeNarrationPrompt)(recipe);\n        const model = \"gemini-2.0-flash\";\n        console.info(\"Getting recipe narration text from LM Studio...\");\n        const response = await lmStudio.chat.completions.create({\n            model,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 1500,\n            temperature: 0.6\n        });\n        const _id = await saveLMStudioResponses({\n            userId,\n            prompt,\n            response,\n            model\n        });\n        return response.choices[0].message?.content;\n    } catch (error) {\n        console.error(\"Failed to generate recipe narration with LM Studio:\", error);\n        throw new Error(\"Failed to generate recipe narration\");\n    }\n};\n// Generate text-to-speech using Web Speech API (browser-based)\nconst getTTS = async (recipe, userId)=>{\n    try {\n        const text = await getRecipeNarration(recipe, userId);\n        if (!text) throw new Error(\"Unable to get text for recipe narration\");\n        // Return the text for client-side TTS using Web Speech API\n        // The actual TTS will be handled on the frontend\n        return text;\n    } catch (error) {\n        console.error(\"Failed to prepare TTS text:\", error);\n        throw new Error(\"Failed to prepare TTS text\");\n    }\n};\n// Generate tags for a recipe using LM Studio\nconst generateRecipeTags = async (recipe, userId)=>{\n    try {\n        const prompt = (0,_prompts__WEBPACK_IMPORTED_MODULE_2__.getRecipeTaggingPrompt)(recipe);\n        const model = \"gemini-2.0-flash\";\n        console.info(\"Generating recipe tags with LM Studio...\");\n        const response = await lmStudio.chat.completions.create({\n            model,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 300,\n            temperature: 0.4\n        });\n        await saveLMStudioResponses({\n            userId,\n            prompt,\n            response,\n            model\n        });\n        const [tagsObject] = response.choices;\n        const rawTags = tagsObject.message?.content?.trim();\n        let tagsArray = [];\n        if (rawTags) {\n            try {\n                tagsArray = JSON.parse(rawTags);\n                if (!Array.isArray(tagsArray) || tagsArray.some((tag)=>typeof tag !== \"string\")) {\n                    throw new Error(\"Invalid JSON structure: Expected an array of strings.\");\n                }\n            } catch (jsonError) {\n                console.error(\"JSON parsing error:\", jsonError);\n                console.error(\"Received malformed JSON:\", rawTags);\n                throw new Error(`Failed to parse tags from LM Studio response. --> ${jsonError}`);\n            }\n        }\n        if (tagsArray.length) {\n            const tags = tagsArray.map((tag)=>({\n                    tag: tag.toLowerCase()\n                }));\n            console.info(`Adding tags -> ${tagsArray} for new recipe -> ${recipe.name} from LM Studio`);\n            await _prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].recipe.update({\n                where: {\n                    id: recipe.id\n                },\n                data: {\n                    tags\n                }\n            });\n        }\n        return;\n    } catch (error) {\n        console.error(\"Failed to generate tags for the recipe with LM Studio:\", error);\n        throw new Error(`Failed to generate tags for the recipe --> ${error}`);\n    }\n};\n// Generate a chat response using LM Studio\nconst generateChatResponse = async (message, recipe, history, userId)=>{\n    try {\n        const model = \"gemini-2.0-flash\";\n        const messages = [\n            {\n                role: \"system\",\n                content: (0,_prompts__WEBPACK_IMPORTED_MODULE_2__.getChatAssistantSystemPrompt)(recipe)\n            },\n            ...history,\n            {\n                role: \"user\",\n                content: message\n            }\n        ];\n        console.info(\"Generating chat response with LM Studio...\");\n        const response = await lmStudio.chat.completions.create({\n            model,\n            messages,\n            max_tokens: 800,\n            temperature: 0.7\n        });\n        const reply = response.choices?.[0]?.message?.content ?? \"Sorry, I had trouble responding.\";\n        const totalTokens = response.usage?.total_tokens ?? 0;\n        // Save to DB only on first message\n        if (history.length === 1) {\n            await saveLMStudioResponses({\n                userId,\n                prompt: `Chat session started for recipe: ${recipe.name}, first message: ${message}`,\n                response,\n                model\n            });\n        }\n        return {\n            reply,\n            totalTokens\n        };\n    } catch (error) {\n        console.error(\"Failed to generate chat response with LM Studio:\", error);\n        return {\n            reply: \"Sorry, I had trouble responding.\",\n            totalTokens: 0\n        };\n    }\n};\n// Health check function to verify LM Studio connection\nconst checkLMStudioHealth = async ()=>{\n    try {\n        const response = await lmStudio.chat.completions.create({\n            model: \"gemini-2.0-flash\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: \"Hello\"\n                }\n            ],\n            max_tokens: 10\n        });\n        return response.choices?.[0]?.message?.content !== undefined;\n    } catch (error) {\n        console.error(\"LM Studio health check failed:\", error);\n        return false;\n    }\n};\n// Get available models from LM Studio\nconst getAvailableModels = async ()=>{\n    try {\n        const response = await lmStudio.models.list();\n        return response.data.map((model)=>model.id);\n    } catch (error) {\n        console.error(\"Failed to get available models from LM Studio:\", error);\n        return [\n            \"gemini-2.0-flash\"\n        ]; // fallback\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RTtBQUNGLEVBQUU7QUFFRix1REFBdUQ7QUFDaEQsTUFBTUMsc0JBQXNCO0lBQ2pDLElBQUk7UUFDRixNQUFNL0QsV0FBVyxNQUFNTixTQUFTd0IsSUFBSSxDQUFDQyxXQUFXLENBQUNmLE1BQU0sQ0FBQztZQUN0REgsT0FBTztZQUNQbUIsVUFBVTtnQkFBQztvQkFBRUMsTUFBTTtvQkFBUUMsU0FBUztnQkFBUTthQUFFO1lBQzlDQyxZQUFZO1FBQ2Q7UUFFQSxPQUFPdkIsU0FBUzZCLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRUMsU0FBU1IsWUFBWTBDO0lBQ3JELEVBQUUsT0FBT3BELE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsT0FBTztJQUNUO0FBQ0YsRUFBRTtBQUVGLHNDQUFzQztBQUMvQixNQUFNcUQscUJBQXFCO0lBQ2hDLElBQUk7UUFDRixNQUFNakUsV0FBVyxNQUFNTixTQUFTd0UsTUFBTSxDQUFDQyxJQUFJO1FBQzNDLE9BQU9uRSxTQUFTSyxJQUFJLENBQUNpRCxHQUFHLENBQUNyRCxDQUFBQSxRQUFTQSxNQUFNVSxFQUFFO0lBQzVDLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsa0RBQWtEQTtRQUNoRSxPQUFPO1lBQUM7U0FBbUIsRUFBRSxXQUFXO0lBQzFDO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NtYXJ0LXJlY2lwZS1nZW5lcmF0b3ItbG9jYWwvLi9zcmMvbGliL2xtc3R1ZGlvLnRzPzljZTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknO1xyXG5pbXBvcnQgeyBJbmdyZWRpZW50LCBEaWV0YXJ5UHJlZmVyZW5jZSwgUmVjaXBlLCBFeHRlbmRlZFJlY2lwZSwgTE1TdHVkaW9Db25maWcsIExNU3R1ZGlvUmVzcG9uc2UgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XHJcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi9wcmlzbWEnO1xyXG5pbXBvcnQge1xyXG4gIGdldFJlY2lwZUdlbmVyYXRpb25Qcm9tcHQsXHJcbiAgZ2V0SW5ncmVkaWVudFZhbGlkYXRpb25Qcm9tcHQsXHJcbiAgZ2V0UmVjaXBlTmFycmF0aW9uUHJvbXB0LFxyXG4gIGdldFJlY2lwZVRhZ2dpbmdQcm9tcHQsXHJcbiAgZ2V0Q2hhdEFzc2lzdGFudFN5c3RlbVByb21wdFxyXG59IGZyb20gJy4vcHJvbXB0cyc7XHJcblxyXG4vLyBMTSBTdHVkaW8gY29uZmlndXJhdGlvblxyXG5jb25zdCBMTV9TVFVESU9fQkFTRV9VUkwgPSBwcm9jZXNzLmVudi5MTV9TVFVESU9fQkFTRV9VUkw7XHJcbmNvbnN0IExNX1NUVURJT19BUElfS0VZID0gcHJvY2Vzcy5lbnYuTE1fU1RVRElPX0FQSV9LRVk7XHJcblxyXG4vLyBJbml0aWFsaXplIE9wZW5BSSBjbGllbnQgY29uZmlndXJlZCBmb3IgTE0gU3R1ZGlvXHJcbmNvbnN0IGxtU3R1ZGlvID0gbmV3IE9wZW5BSSh7XHJcbiAgYmFzZVVSTDogTE1fU1RVRElPX0JBU0VfVVJMLFxyXG4gIGFwaUtleTogTE1fU1RVRElPX0FQSV9LRVksXHJcbn0pO1xyXG5cclxuLy8gU2F2ZSBMTSBTdHVkaW8gcmVzcG9uc2VzIGluIHRoZSBkYXRhYmFzZSBmb3IgbG9nZ2luZy90cmFja2luZ1xyXG50eXBlIFNhdmVMTVN0dWRpb1Jlc3BvbnNlc1R5cGUgPSB7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgcHJvbXB0OiBzdHJpbmc7XHJcbiAgcmVzcG9uc2U6IGFueTtcclxuICBtb2RlbD86IHN0cmluZztcclxufTtcclxuXHJcbmNvbnN0IHNhdmVMTVN0dWRpb1Jlc3BvbnNlcyA9IGFzeW5jICh7IHVzZXJJZCwgcHJvbXB0LCByZXNwb25zZSwgbW9kZWwgfTogU2F2ZUxNU3R1ZGlvUmVzcG9uc2VzVHlwZSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBhaUdlbmVyYXRlZCA9IGF3YWl0IHByaXNtYS5hSUdlbmVyYXRlZC5jcmVhdGUoe1xyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdXNlcklkLFxyXG4gICAgICAgIHByb21wdCxcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBtb2RlbDogbW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnLFxyXG4gICAgICAgIHRva2VuczogcmVzcG9uc2UudXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwLFxyXG4gICAgICAgIGNvc3Q6IDAsIC8vIFlvdSBjYW4gY2FsY3VsYXRlIGNvc3QgYmFzZWQgb24gdG9rZW5zIGlmIG5lZWRlZFxyXG4gICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gYWlHZW5lcmF0ZWQuaWQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIExNIFN0dWRpbyByZXNwb25zZSB0byBkYjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn07XHJcblxyXG50eXBlIFJlc3BvbnNlVHlwZSA9IHtcclxuICByZWNpcGVzOiBzdHJpbmcgfCBudWxsO1xyXG4gIG9wZW5haVByb21wdElkOiBzdHJpbmc7XHJcbn07XHJcblxyXG4vLyBHZW5lcmF0ZSByZWNpcGVzIHVzaW5nIExNIFN0dWRpb1xyXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVSZWNpcGUgPSBhc3luYyAoXHJcbiAgaW5ncmVkaWVudHM6IEluZ3JlZGllbnRbXSxcclxuICBkaWV0YXJ5UHJlZmVyZW5jZXM6IERpZXRhcnlQcmVmZXJlbmNlW10sXHJcbiAgdXNlcklkOiBzdHJpbmdcclxuKTogUHJvbWlzZTxSZXNwb25zZVR5cGU+ID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gZ2V0UmVjaXBlR2VuZXJhdGlvblByb21wdChpbmdyZWRpZW50cywgZGlldGFyeVByZWZlcmVuY2VzKTtcclxuICAgIGNvbnN0IG1vZGVsID0gJ2dlbWluaS0yLjAtZmxhc2gnO1xyXG5cclxuICAgIGNvbnNvbGUuaW5mbygnR2VuZXJhdGluZyByZWNpcGVzIGZyb20gTE0gU3R1ZGlvLi4uJyk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbVN0dWRpby5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBtZXNzYWdlczogW3tcclxuICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgY29udGVudDogcHJvbXB0LFxyXG4gICAgICB9XSxcclxuICAgICAgbWF4X3Rva2VuczogMjAwMCxcclxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcclxuICAgICAgdG9wX3A6IDAuOSxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdMTSBTdHVkaW8gcmVzcG9uc2UgcmVjZWl2ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblxyXG4gICAgY29uc3QgX2lkID0gYXdhaXQgc2F2ZUxNU3R1ZGlvUmVzcG9uc2VzKHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICBwcm9tcHQsXHJcbiAgICAgIHJlc3BvbnNlLFxyXG4gICAgICBtb2RlbCxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlY2lwZXM6IHJlc3BvbnNlLmNob2ljZXNbMF0ubWVzc2FnZT8uY29udGVudCxcclxuICAgICAgb3BlbmFpUHJvbXB0SWQ6IF9pZCB8fCAnbnVsbC1wcm9tcHQtaWQnXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgcmVjaXBlIHdpdGggTE0gU3R1ZGlvOicsIGVycm9yKTtcclxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1lc3NhZ2U6JywgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YWNrOicsIGVycm9yLnN0YWNrKTtcclxuICAgIH1cclxuICAgIC8vIFJlLXRocm93IHdpdGggbW9yZSBzcGVjaWZpYyBlcnJvciBpbmZvcm1hdGlvblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBMTSBTdHVkaW8gRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gVmFsaWRhdGUgYW4gaW5ncmVkaWVudCBuYW1lIHVzaW5nIExNIFN0dWRpb1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGVJbmdyZWRpZW50ID0gYXN5bmMgKGluZ3JlZGllbnROYW1lOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGdldEluZ3JlZGllbnRWYWxpZGF0aW9uUHJvbXB0KGluZ3JlZGllbnROYW1lKTtcclxuICAgIGNvbnN0IG1vZGVsID0gJ2dlbWluaS0yLjAtZmxhc2gnO1xyXG5cclxuICAgIGNvbnNvbGUuaW5mbygnVmFsaWRhdGluZyBpbmdyZWRpZW50IHdpdGggTE0gU3R1ZGlvLi4uJyk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbVN0dWRpby5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBtZXNzYWdlczogW3tcclxuICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgY29udGVudDogcHJvbXB0LFxyXG4gICAgICB9XSxcclxuICAgICAgbWF4X3Rva2VuczogNTAwLFxyXG4gICAgICB0ZW1wZXJhdHVyZTogMC4zLFxyXG4gICAgfSk7XHJcblxyXG4gICAgYXdhaXQgc2F2ZUxNU3R1ZGlvUmVzcG9uc2VzKHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICBwcm9tcHQsXHJcbiAgICAgIHJlc3BvbnNlLFxyXG4gICAgICBtb2RlbCxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2U/LmNvbnRlbnQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB2YWxpZGF0ZSBpbmdyZWRpZW50IHdpdGggTE0gU3R1ZGlvOicsIGVycm9yKTtcclxuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHZhbGlkYXRlIGluZ3JlZGllbnQnKTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBHZXQgcmVjaXBlIG5hcnJhdGlvbiB0ZXh0IHVzaW5nIExNIFN0dWRpb1xyXG5jb25zdCBnZXRSZWNpcGVOYXJyYXRpb24gPSBhc3luYyAocmVjaXBlOiBFeHRlbmRlZFJlY2lwZSwgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+ID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gZ2V0UmVjaXBlTmFycmF0aW9uUHJvbXB0KHJlY2lwZSk7XHJcbiAgICBjb25zdCBtb2RlbCA9ICdnZW1pbmktMi4wLWZsYXNoJztcclxuXHJcbiAgICBjb25zb2xlLmluZm8oJ0dldHRpbmcgcmVjaXBlIG5hcnJhdGlvbiB0ZXh0IGZyb20gTE0gU3R1ZGlvLi4uJyk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbVN0dWRpby5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBtZXNzYWdlczogW3tcclxuICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgY29udGVudDogcHJvbXB0LFxyXG4gICAgICB9XSxcclxuICAgICAgbWF4X3Rva2VuczogMTUwMCxcclxuICAgICAgdGVtcGVyYXR1cmU6IDAuNixcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IF9pZCA9IGF3YWl0IHNhdmVMTVN0dWRpb1Jlc3BvbnNlcyh7XHJcbiAgICAgIHVzZXJJZCxcclxuICAgICAgcHJvbXB0LFxyXG4gICAgICByZXNwb25zZSxcclxuICAgICAgbW9kZWwsXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzcG9uc2UuY2hvaWNlc1swXS5tZXNzYWdlPy5jb250ZW50O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgcmVjaXBlIG5hcnJhdGlvbiB3aXRoIExNIFN0dWRpbzonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSByZWNpcGUgbmFycmF0aW9uJyk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gR2VuZXJhdGUgdGV4dC10by1zcGVlY2ggdXNpbmcgV2ViIFNwZWVjaCBBUEkgKGJyb3dzZXItYmFzZWQpXHJcbmV4cG9ydCBjb25zdCBnZXRUVFMgPSBhc3luYyAocmVjaXBlOiBFeHRlbmRlZFJlY2lwZSwgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZ2V0UmVjaXBlTmFycmF0aW9uKHJlY2lwZSwgdXNlcklkKTtcclxuICAgIGlmICghdGV4dCkgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gZ2V0IHRleHQgZm9yIHJlY2lwZSBuYXJyYXRpb24nKTtcclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIHRleHQgZm9yIGNsaWVudC1zaWRlIFRUUyB1c2luZyBXZWIgU3BlZWNoIEFQSVxyXG4gICAgLy8gVGhlIGFjdHVhbCBUVFMgd2lsbCBiZSBoYW5kbGVkIG9uIHRoZSBmcm9udGVuZFxyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwcmVwYXJlIFRUUyB0ZXh0OicsIGVycm9yKTtcclxuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHByZXBhcmUgVFRTIHRleHQnKTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBHZW5lcmF0ZSB0YWdzIGZvciBhIHJlY2lwZSB1c2luZyBMTSBTdHVkaW9cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUmVjaXBlVGFncyA9IGFzeW5jIChyZWNpcGU6IEV4dGVuZGVkUmVjaXBlLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4gPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBnZXRSZWNpcGVUYWdnaW5nUHJvbXB0KHJlY2lwZSk7XHJcbiAgICBjb25zdCBtb2RlbCA9ICdnZW1pbmktMi4wLWZsYXNoJztcclxuXHJcbiAgICBjb25zb2xlLmluZm8oJ0dlbmVyYXRpbmcgcmVjaXBlIHRhZ3Mgd2l0aCBMTSBTdHVkaW8uLi4nKTtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxtU3R1ZGlvLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgbW9kZWwsXHJcbiAgICAgIG1lc3NhZ2VzOiBbe1xyXG4gICAgICAgIHJvbGU6ICd1c2VyJyxcclxuICAgICAgICBjb250ZW50OiBwcm9tcHQsXHJcbiAgICAgIH1dLFxyXG4gICAgICBtYXhfdG9rZW5zOiAzMDAsXHJcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjQsXHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCBzYXZlTE1TdHVkaW9SZXNwb25zZXMoe1xyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHByb21wdCxcclxuICAgICAgcmVzcG9uc2UsXHJcbiAgICAgIG1vZGVsLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgW3RhZ3NPYmplY3RdID0gcmVzcG9uc2UuY2hvaWNlcztcclxuICAgIGNvbnN0IHJhd1RhZ3MgPSB0YWdzT2JqZWN0Lm1lc3NhZ2U/LmNvbnRlbnQ/LnRyaW0oKTtcclxuICAgIGxldCB0YWdzQXJyYXk6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgaWYgKHJhd1RhZ3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0YWdzQXJyYXkgPSBKU09OLnBhcnNlKHJhd1RhZ3MpO1xyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0YWdzQXJyYXkpIHx8IHRhZ3NBcnJheS5zb21lKHRhZyA9PiB0eXBlb2YgdGFnICE9PSAnc3RyaW5nJykpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBKU09OIHN0cnVjdHVyZTogRXhwZWN0ZWQgYW4gYXJyYXkgb2Ygc3RyaW5ncy4nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGpzb25FcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gcGFyc2luZyBlcnJvcjonLCBqc29uRXJyb3IpO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlY2VpdmVkIG1hbGZvcm1lZCBKU09OOicsIHJhd1RhZ3MpO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIHRhZ3MgZnJvbSBMTSBTdHVkaW8gcmVzcG9uc2UuIC0tPiAke2pzb25FcnJvcn1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0YWdzQXJyYXkubGVuZ3RoKSB7XHJcbiAgICAgIGNvbnN0IHRhZ3MgPSB0YWdzQXJyYXkubWFwKCh0YWc6IHN0cmluZykgPT4gKHsgdGFnOiB0YWcudG9Mb3dlckNhc2UoKSB9KSk7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgQWRkaW5nIHRhZ3MgLT4gJHt0YWdzQXJyYXl9IGZvciBuZXcgcmVjaXBlIC0+ICR7cmVjaXBlLm5hbWV9IGZyb20gTE0gU3R1ZGlvYCk7XHJcbiAgICAgIGF3YWl0IHByaXNtYS5yZWNpcGUudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogcmVjaXBlLmlkIH0sXHJcbiAgICAgICAgZGF0YTogeyB0YWdzIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgdGFncyBmb3IgdGhlIHJlY2lwZSB3aXRoIExNIFN0dWRpbzonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZW5lcmF0ZSB0YWdzIGZvciB0aGUgcmVjaXBlIC0tPiAke2Vycm9yfWApO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdlbmVyYXRlIGEgY2hhdCByZXNwb25zZSB1c2luZyBMTSBTdHVkaW9cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlQ2hhdFJlc3BvbnNlID0gYXN5bmMgKFxyXG4gIG1lc3NhZ2U6IHN0cmluZyxcclxuICByZWNpcGU6IEV4dGVuZGVkUmVjaXBlLFxyXG4gIGhpc3Rvcnk6IGFueVtdLFxyXG4gIHVzZXJJZDogc3RyaW5nXHJcbik6IFByb21pc2U8eyByZXBseTogc3RyaW5nOyB0b3RhbFRva2VuczogbnVtYmVyIH0+ID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbW9kZWwgPSAnZ2VtaW5pLTIuMC1mbGFzaCc7XHJcbiAgICBjb25zdCBtZXNzYWdlcyA9IFtcclxuICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogZ2V0Q2hhdEFzc2lzdGFudFN5c3RlbVByb21wdChyZWNpcGUpIH0sXHJcbiAgICAgIC4uLmhpc3RvcnksXHJcbiAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBtZXNzYWdlIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnNvbGUuaW5mbygnR2VuZXJhdGluZyBjaGF0IHJlc3BvbnNlIHdpdGggTE0gU3R1ZGlvLi4uJyk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbVN0dWRpby5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBtZXNzYWdlcyxcclxuICAgICAgbWF4X3Rva2VuczogODAwLFxyXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgcmVwbHkgPSByZXNwb25zZS5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgPz8gJ1NvcnJ5LCBJIGhhZCB0cm91YmxlIHJlc3BvbmRpbmcuJztcclxuICAgIGNvbnN0IHRvdGFsVG9rZW5zID0gcmVzcG9uc2UudXNhZ2U/LnRvdGFsX3Rva2VucyA/PyAwO1xyXG5cclxuICAgIC8vIFNhdmUgdG8gREIgb25seSBvbiBmaXJzdCBtZXNzYWdlXHJcbiAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgYXdhaXQgc2F2ZUxNU3R1ZGlvUmVzcG9uc2VzKHtcclxuICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgcHJvbXB0OiBgQ2hhdCBzZXNzaW9uIHN0YXJ0ZWQgZm9yIHJlY2lwZTogJHtyZWNpcGUubmFtZX0sIGZpcnN0IG1lc3NhZ2U6ICR7bWVzc2FnZX1gLFxyXG4gICAgICAgIHJlc3BvbnNlLFxyXG4gICAgICAgIG1vZGVsLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyByZXBseSwgdG90YWxUb2tlbnMgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIGNoYXQgcmVzcG9uc2Ugd2l0aCBMTSBTdHVkaW86JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcmVwbHk6ICdTb3JyeSwgSSBoYWQgdHJvdWJsZSByZXNwb25kaW5nLicsIHRvdGFsVG9rZW5zOiAwIH07XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gSGVhbHRoIGNoZWNrIGZ1bmN0aW9uIHRvIHZlcmlmeSBMTSBTdHVkaW8gY29ubmVjdGlvblxyXG5leHBvcnQgY29uc3QgY2hlY2tMTVN0dWRpb0hlYWx0aCA9IGFzeW5jICgpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbVN0dWRpby5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsOiAnZ2VtaW5pLTIuMC1mbGFzaCcsXHJcbiAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICdIZWxsbycgfV0sXHJcbiAgICAgIG1heF90b2tlbnM6IDEwLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmNob2ljZXM/LlswXT8ubWVzc2FnZT8uY29udGVudCAhPT0gdW5kZWZpbmVkO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdMTSBTdHVkaW8gaGVhbHRoIGNoZWNrIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gR2V0IGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBMTSBTdHVkaW9cclxuZXhwb3J0IGNvbnN0IGdldEF2YWlsYWJsZU1vZGVscyA9IGFzeW5jICgpOiBQcm9taXNlPHN0cmluZ1tdPiA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbG1TdHVkaW8ubW9kZWxzLmxpc3QoKTtcclxuICAgIHJldHVybiByZXNwb25zZS5kYXRhLm1hcChtb2RlbCA9PiBtb2RlbC5pZCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgYXZhaWxhYmxlIG1vZGVscyBmcm9tIExNIFN0dWRpbzonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gWydnZW1pbmktMi4wLWZsYXNoJ107IC8vIGZhbGxiYWNrXHJcbiAgfVxyXG59O1xyXG4iXSwibmFtZXMiOlsiT3BlbkFJIiwicHJpc21hIiwiZ2V0UmVjaXBlR2VuZXJhdGlvblByb21wdCIsImdldEluZ3JlZGllbnRWYWxpZGF0aW9uUHJvbXB0IiwiZ2V0UmVjaXBlTmFycmF0aW9uUHJvbXB0IiwiZ2V0UmVjaXBlVGFnZ2luZ1Byb21wdCIsImdldENoYXRBc3Npc3RhbnRTeXN0ZW1Qcm9tcHQiLCJMTV9TVFVESU9fQkFTRV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiTE1fU1RVRElPX0FQSV9LRVkiLCJsbVN0dWRpbyIsImJhc2VVUkwiLCJhcGlLZXkiLCJzYXZlTE1TdHVkaW9SZXNwb25zZXMiLCJ1c2VySWQiLCJwcm9tcHQiLCJyZXNwb25zZSIsIm1vZGVsIiwiYWlHZW5lcmF0ZWQiLCJhSUdlbmVyYXRlZCIsImNyZWF0ZSIsImRhdGEiLCJ0b2tlbnMiLCJ1c2FnZSIsInRvdGFsX3Rva2VucyIsImNvc3QiLCJzdGF0dXMiLCJpZCIsImVycm9yIiwiY29uc29sZSIsImdlbmVyYXRlUmVjaXBlIiwiaW5ncmVkaWVudHMiLCJkaWV0YXJ5UHJlZmVyZW5jZXMiLCJpbmZvIiwiY2hhdCIsImNvbXBsZXRpb25zIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsInRvcF9wIiwibG9nIiwiX2lkIiwicmVjaXBlcyIsImNob2ljZXMiLCJtZXNzYWdlIiwib3BlbmFpUHJvbXB0SWQiLCJFcnJvciIsInN0YWNrIiwidmFsaWRhdGVJbmdyZWRpZW50IiwiaW5ncmVkaWVudE5hbWUiLCJnZXRSZWNpcGVOYXJyYXRpb24iLCJyZWNpcGUiLCJnZXRUVFMiLCJ0ZXh0IiwiZ2VuZXJhdGVSZWNpcGVUYWdzIiwidGFnc09iamVjdCIsInJhd1RhZ3MiLCJ0cmltIiwidGFnc0FycmF5IiwiSlNPTiIsInBhcnNlIiwiQXJyYXkiLCJpc0FycmF5Iiwic29tZSIsInRhZyIsImpzb25FcnJvciIsImxlbmd0aCIsInRhZ3MiLCJtYXAiLCJ0b0xvd2VyQ2FzZSIsIm5hbWUiLCJ1cGRhdGUiLCJ3aGVyZSIsImdlbmVyYXRlQ2hhdFJlc3BvbnNlIiwiaGlzdG9yeSIsInJlcGx5IiwidG90YWxUb2tlbnMiLCJjaGVja0xNU3R1ZGlvSGVhbHRoIiwidW5kZWZpbmVkIiwiZ2V0QXZhaWxhYmxlTW9kZWxzIiwibW9kZWxzIiwibGlzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/lmstudio.ts\n");

/***/ }),

/***/ "(api)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQThDO0FBRTlDLE1BQU1DLGtCQUFrQkM7QUFJakIsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUksSUFBSUgsd0RBQVlBLEdBQUc7QUFFbkUsSUFBSUksSUFBeUIsRUFBY0gsZ0JBQWdCRSxNQUFNLEdBQUdBO0FBRXBFLGlFQUFlQSxNQUFNQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnQtcmVjaXBlLWdlbmVyYXRvci1sb2NhbC8uL3NyYy9saWIvcHJpc21hLnRzPzAxZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoKTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XG5cbmV4cG9ydCBkZWZhdWx0IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(api)/./src/lib/prompts.ts":
/*!****************************!*\
  !*** ./src/lib/prompts.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getChatAssistantSystemPrompt: () => (/* binding */ getChatAssistantSystemPrompt),\n/* harmony export */   getImageGenerationPrompt: () => (/* binding */ getImageGenerationPrompt),\n/* harmony export */   getIngredientValidationPrompt: () => (/* binding */ getIngredientValidationPrompt),\n/* harmony export */   getRecipeGenerationPrompt: () => (/* binding */ getRecipeGenerationPrompt),\n/* harmony export */   getRecipeNarrationPrompt: () => (/* binding */ getRecipeNarrationPrompt),\n/* harmony export */   getRecipeTaggingPrompt: () => (/* binding */ getRecipeTaggingPrompt)\n/* harmony export */ });\nconst getRecipeGenerationPrompt = (ingredients, dietaryPreferences)=>`\nI have the following ingredients: ${JSON.stringify(ingredients)}\n${dietaryPreferences.length ? `and dietary preferences: ${dietaryPreferences.join(\",\")}` : \"\"}.\n\nPlease provide me with three different delicious and diverse recipes. The response should be in the following JSON format without any additional text, markdown, or code formatting (e.g., no backticks):\n\n[\n  {\n    \"name\": \"Recipe Name\",\n    \"ingredients\": [\n      {\"name\": \"Ingredient 1\", \"quantity\": \"quantity and unit\"},\n      {\"name\": \"Ingredient 2\", \"quantity\": \"quantity and unit\"},\n      ...\n    ],\n    \"instructions\": [\n      \"Do this first.\",\n      \"Then do this.\",\n      ...\n    ],\n    \"dietaryPreference\": [\"Preference 1\", \"Preference 2\", ...],\n    \"additionalInformation\": {\n      \"tips\": \"Provide practical cooking tips, such as using the right cookware or ingredient substitutions.\",\n      \"variations\": \"Suggest creative variations for the recipe, like adding more vegetables or using different proteins.\",\n      \"servingSuggestions\": \"Include ideas for how to serve the dish (e.g., with toast, salad, or specific sauces).\",\n      \"nutritionalInformation\": \"Provide approximate nutritional details (e.g., calories, protein, fat, etc.).\"\n    }\n  },\n  ...\n]\n\nPlease ensure the recipes are diverse in type or cuisine (e.g., different meal categories or international flavors) and use all the ingredients listed unless dietary preferences or practicality dictate otherwise. Quantities must include appropriate units (e.g., grams, cups, teaspoons) for precision. Provide clear, detailed instructions suitable for someone with basic cooking skills. The instructions should be ordered but not include step numbers. Additionally, ensure the recipes respect the dietary preferences provided by suggesting suitable alternatives where necessary. The JSON must be valid and parsable without any additional text or formatting outside the JSON structure.\n`;\nconst getImageGenerationPrompt = (recipeName, ingredients)=>{\n    const allIngredients = ingredients.map((ingredient)=>`${ingredient.name} (${ingredient.quantity})`).join(\", \");\n    const prompt = `\nCreate a high-resolution, photorealistic image of a delicious ${recipeName} made of these ingredients: ${allIngredients}. The image should be visually appealing, showcasing the dish in an appetizing manner. It should be plated attractively on a clean white plate with natural lighting, highlighting key ingredients for visual appeal.\n`;\n    return prompt.trim();\n};\nconst getIngredientValidationPrompt = (ingredientName)=>{\n    const prompt = `Act as a Food Ingredient Validation Assistant. Given the ingredient name: ${ingredientName}, your task is to evaluate the ingredient and return a JSON object with exactly two keys:\n\n{\n  \"isValid\": true/false,\n  \"possibleVariations\": [\"variation1\", \"variation2\", \"variation3\"]\n}\n\nRules:\nThe isValid field must be true if the ingredient is commonly used in recipes, and false otherwise.\nThe possibleVariations field must contain an array of 2 to 3 valid variations, alternative names, or related ingredients for the given ingredient. If the ingredient appears to be a misspelling, include the corrected name(s) in this array. If there are no recognized variations or corrections, return an empty array for possibleVariations.\nThe output must be strictly valid JSON without any additional text, markdown formatting, or code blocks.\n\nExamples:\nInput: \"cheese\"\nExpected Output: { \"isValid\": true, \"possibleVariations\": [\"cheddar\", \"mozzarella\", \"parmesan\"] }\n\nInput: \"breakfast\"\nExpected Output: { \"isValid\": false, \"possibleVariations\": [] }\n\nInput: \"cuscus\"\nExpected Output: { \"isValid\": false, \"possibleVariations\": [\"couscous\"] }`;\n    return prompt;\n};\nconst getRecipeNarrationPrompt = (recipe)=>{\n    if (!recipe || !recipe.name || !recipe.ingredients || !recipe.instructions) {\n        return \"Invalid recipe data. Please provide a valid recipe.\";\n    }\n    const { name, ingredients, instructions, additionalInformation } = recipe;\n    return `Convert the following recipe into a **clear, well-paced, and engaging spoken narration**.\n\n- The tone should be **natural, informative, and confident**, like a professional chef explaining a recipe in a calm and collected manner.\n- Keep it **concise and instructional**, focusing on delivering the steps in an **efficient and natural way** without excessive enthusiasm.\n- Transitions should be **smooth but to the point**—avoid over-explaining or dramatizing the process.\n\n---\n\n### Recipe: **${name}**\n\n#### Ingredients:\n${ingredients.map((ing)=>`- **${ing.quantity}** of **${ing.name}**`).join(\"\\n\")}\n\n#### Instructions:\n${instructions.map((step, index)=>`${index + 1}. ${step}`).join(\"\\n\")}\n\n${additionalInformation?.tips ? `#### Tips:\\n${additionalInformation.tips}\\n` : \"\"}\n${additionalInformation?.variations ? `#### Variations:\\n${additionalInformation.variations}\\n` : \"\"}\n${additionalInformation?.servingSuggestions ? `#### Serving Suggestions:\\n${additionalInformation.servingSuggestions}\\n` : \"\"}\n${additionalInformation?.nutritionalInformation ? `#### Nutritional Info:\\n${additionalInformation.nutritionalInformation}\\n` : \"\"}\n\n---\n\n🎙 **Narration Guidelines:**\n- Deliver the narration in a **calm and professional manner**, without excessive excitement.\n- Read ingredients **clearly and efficiently**—avoid unnecessary emphasis or dramatization.\n- Guide the user **step-by-step with smooth but direct transitions**, keeping it **practical and instructional**.\n- End with a **brief, professional wrap-up**, reinforcing the dish's appeal in a **neutral and informative way**.\n- **Keep it around 60-90 seconds**—engaging but not rushed.\n\nEnsure the narration **sounds knowledgeable and practical**, maintaining a **professional and refined delivery.**`;\n};\nconst getRecipeTaggingPrompt = (recipe)=>{\n    const { name, ingredients, dietaryPreference, additionalInformation } = recipe;\n    // Extract ingredient names\n    const ingredientNames = ingredients.map((ingredient)=>ingredient.name).join(\", \");\n    // Extract additional information\n    const { tips, variations, servingSuggestions, nutritionalInformation } = additionalInformation;\n    // Construct the prompt\n    const prompt = `Please generate **10 unique, single-word tags** for the following recipe in a **pure JSON array format**.\n\n**Rules for the response:**\n1. The response **must be a valid JSON array** and **must NOT be wrapped in markdown, backticks, or any other formatting**.\n2. The array should contain **10 unique, single-word tags** that:\n   - **Accurately describe the recipe** based on its name, ingredients, dietary preferences, and additional information.\n   - **Are commonly searched terms** for similar recipes.\n   - **Include keywords** related to the recipe type, cuisine, or dietary category.\n   - **Are concise**, avoiding technical or uncommon terms.\n\n### **Example Valid Response:**\n[\"vegetarian\", \"dessert\", \"corn\", \"pudding\", \"Indian\", \"sweet\", \"almond\", \"cardamom\", \"saffron\", \"coconut\"]\n\n### **Recipe Details:**\n- **Recipe Name**: ${name}\n- **Main Ingredients**: ${ingredientNames}\n- **Dietary Preferences**: ${dietaryPreference.join(\", \")}\n- **Additional Information**:\n  - **Tips**: ${tips}\n  - **Variations**: ${variations}\n  - **Serving Suggestions**: ${servingSuggestions}\n  - **Nutritional Information**: ${nutritionalInformation}`;\n    return prompt;\n};\nconst getChatAssistantSystemPrompt = (recipe)=>{\n    const { name, ingredients, instructions, additionalInformation, dietaryPreference } = recipe;\n    const systemPrompt = `\nYou are a helpful recipe assistant. You only respond to questions that are directly related to the following recipe:\n\nName: ${name}\nIngredients: ${ingredients.map((i)=>`${i.quantity} ${i.name}`).join(\", \")}\nDietary Preferences: ${dietaryPreference.map((p)=>`${p}`).join(\", \")}\nInstructions: ${instructions}\nTips: ${additionalInformation.tips}\nVariations: ${additionalInformation.variations}\nServing Suggestions: ${additionalInformation.servingSuggestions}\nNutritional Info: ${additionalInformation.nutritionalInformation}\n\nYou may provide useful suggestions about ingredient substitutions, dietary modifications, cooking techniques, tools, or serving advice — as long as they apply specifically to this recipe.\n\nIf the user asks about anything not related to this recipe — including general cooking topics, science, history, entertainment, or other off-topic subjects — politely decline and guide them back to questions about the recipe: ${name}.\n`.trim();\n    return systemPrompt;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7Ozs7Ozs7Ozs7Ozs7O21CQWNDLEVBQUVGLEtBQUs7d0JBQ0YsRUFBRW1CLGdCQUFnQjsyQkFDZixFQUFFRCxrQkFBa0J4QixJQUFJLENBQUMsTUFBTTs7Y0FFNUMsRUFBRW1CLEtBQUs7b0JBQ0QsRUFBRUMsV0FBVzs2QkFDSixFQUFFQyxtQkFBbUI7aUNBQ2pCLEVBQUVDLHVCQUF1QixDQUFDO0lBRXpELE9BQU9kO0FBQ1QsRUFBRTtBQUVLLE1BQU1rQiwrQkFBK0IsQ0FBQ2I7SUFDM0MsTUFBTSxFQUFFUCxJQUFJLEVBQUVYLFdBQVcsRUFBRW1CLFlBQVksRUFBRUMscUJBQXFCLEVBQUVTLGlCQUFpQixFQUFFLEdBQUdYO0lBRXRGLE1BQU1jLGVBQWUsQ0FBQzs7O01BR2xCLEVBQUVyQixLQUFLO2FBQ0EsRUFBRVgsWUFBWVMsR0FBRyxDQUFDd0IsQ0FBQUEsSUFBSyxDQUFDLEVBQUVBLEVBQUVyQixRQUFRLENBQUMsQ0FBQyxFQUFFcUIsRUFBRXRCLElBQUksQ0FBQyxDQUFDLEVBQUVOLElBQUksQ0FBQyxNQUFNO3FCQUNyRCxFQUFFd0Isa0JBQWtCcEIsR0FBRyxDQUFDeUIsQ0FBQUEsSUFBSyxDQUFDLEVBQUVBLEVBQUUsQ0FBQyxFQUFFN0IsSUFBSSxDQUFDLE1BQU07Y0FDdkQsRUFBRWMsYUFBYTtNQUN2QixFQUFFQyxzQkFBc0JJLElBQUksQ0FBQztZQUN2QixFQUFFSixzQkFBc0JLLFVBQVUsQ0FBQztxQkFDMUIsRUFBRUwsc0JBQXNCTSxrQkFBa0IsQ0FBQztrQkFDOUMsRUFBRU4sc0JBQXNCTyxzQkFBc0IsQ0FBQzs7OztrT0FJaUssRUFBRWhCLEtBQUs7QUFDek8sQ0FBQyxDQUFDRyxJQUFJO0lBRUosT0FBT2tCO0FBQ1QsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NtYXJ0LXJlY2lwZS1nZW5lcmF0b3ItbG9jYWwvLi9zcmMvbGliL3Byb21wdHMudHM/YTY2MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmdyZWRpZW50LCBEaWV0YXJ5UHJlZmVyZW5jZSwgUmVjaXBlLCBFeHRlbmRlZFJlY2lwZSB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcblxuZXhwb3J0IGNvbnN0IGdldFJlY2lwZUdlbmVyYXRpb25Qcm9tcHQgPSAoaW5ncmVkaWVudHM6IEluZ3JlZGllbnRbXSwgZGlldGFyeVByZWZlcmVuY2VzOiBEaWV0YXJ5UHJlZmVyZW5jZVtdKSA9PiBgXG5JIGhhdmUgdGhlIGZvbGxvd2luZyBpbmdyZWRpZW50czogJHtKU09OLnN0cmluZ2lmeShpbmdyZWRpZW50cyl9XG4ke2RpZXRhcnlQcmVmZXJlbmNlcy5sZW5ndGggPyBgYW5kIGRpZXRhcnkgcHJlZmVyZW5jZXM6ICR7ZGlldGFyeVByZWZlcmVuY2VzLmpvaW4oJywnKX1gIDogJyd9LlxuXG5QbGVhc2UgcHJvdmlkZSBtZSB3aXRoIHRocmVlIGRpZmZlcmVudCBkZWxpY2lvdXMgYW5kIGRpdmVyc2UgcmVjaXBlcy4gVGhlIHJlc3BvbnNlIHNob3VsZCBiZSBpbiB0aGUgZm9sbG93aW5nIEpTT04gZm9ybWF0IHdpdGhvdXQgYW55IGFkZGl0aW9uYWwgdGV4dCwgbWFya2Rvd24sIG9yIGNvZGUgZm9ybWF0dGluZyAoZS5nLiwgbm8gYmFja3RpY2tzKTpcblxuW1xuICB7XG4gICAgXCJuYW1lXCI6IFwiUmVjaXBlIE5hbWVcIixcbiAgICBcImluZ3JlZGllbnRzXCI6IFtcbiAgICAgIHtcIm5hbWVcIjogXCJJbmdyZWRpZW50IDFcIiwgXCJxdWFudGl0eVwiOiBcInF1YW50aXR5IGFuZCB1bml0XCJ9LFxuICAgICAge1wibmFtZVwiOiBcIkluZ3JlZGllbnQgMlwiLCBcInF1YW50aXR5XCI6IFwicXVhbnRpdHkgYW5kIHVuaXRcIn0sXG4gICAgICAuLi5cbiAgICBdLFxuICAgIFwiaW5zdHJ1Y3Rpb25zXCI6IFtcbiAgICAgIFwiRG8gdGhpcyBmaXJzdC5cIixcbiAgICAgIFwiVGhlbiBkbyB0aGlzLlwiLFxuICAgICAgLi4uXG4gICAgXSxcbiAgICBcImRpZXRhcnlQcmVmZXJlbmNlXCI6IFtcIlByZWZlcmVuY2UgMVwiLCBcIlByZWZlcmVuY2UgMlwiLCAuLi5dLFxuICAgIFwiYWRkaXRpb25hbEluZm9ybWF0aW9uXCI6IHtcbiAgICAgIFwidGlwc1wiOiBcIlByb3ZpZGUgcHJhY3RpY2FsIGNvb2tpbmcgdGlwcywgc3VjaCBhcyB1c2luZyB0aGUgcmlnaHQgY29va3dhcmUgb3IgaW5ncmVkaWVudCBzdWJzdGl0dXRpb25zLlwiLFxuICAgICAgXCJ2YXJpYXRpb25zXCI6IFwiU3VnZ2VzdCBjcmVhdGl2ZSB2YXJpYXRpb25zIGZvciB0aGUgcmVjaXBlLCBsaWtlIGFkZGluZyBtb3JlIHZlZ2V0YWJsZXMgb3IgdXNpbmcgZGlmZmVyZW50IHByb3RlaW5zLlwiLFxuICAgICAgXCJzZXJ2aW5nU3VnZ2VzdGlvbnNcIjogXCJJbmNsdWRlIGlkZWFzIGZvciBob3cgdG8gc2VydmUgdGhlIGRpc2ggKGUuZy4sIHdpdGggdG9hc3QsIHNhbGFkLCBvciBzcGVjaWZpYyBzYXVjZXMpLlwiLFxuICAgICAgXCJudXRyaXRpb25hbEluZm9ybWF0aW9uXCI6IFwiUHJvdmlkZSBhcHByb3hpbWF0ZSBudXRyaXRpb25hbCBkZXRhaWxzIChlLmcuLCBjYWxvcmllcywgcHJvdGVpbiwgZmF0LCBldGMuKS5cIlxuICAgIH1cbiAgfSxcbiAgLi4uXG5dXG5cblBsZWFzZSBlbnN1cmUgdGhlIHJlY2lwZXMgYXJlIGRpdmVyc2UgaW4gdHlwZSBvciBjdWlzaW5lIChlLmcuLCBkaWZmZXJlbnQgbWVhbCBjYXRlZ29yaWVzIG9yIGludGVybmF0aW9uYWwgZmxhdm9ycykgYW5kIHVzZSBhbGwgdGhlIGluZ3JlZGllbnRzIGxpc3RlZCB1bmxlc3MgZGlldGFyeSBwcmVmZXJlbmNlcyBvciBwcmFjdGljYWxpdHkgZGljdGF0ZSBvdGhlcndpc2UuIFF1YW50aXRpZXMgbXVzdCBpbmNsdWRlIGFwcHJvcHJpYXRlIHVuaXRzIChlLmcuLCBncmFtcywgY3VwcywgdGVhc3Bvb25zKSBmb3IgcHJlY2lzaW9uLiBQcm92aWRlIGNsZWFyLCBkZXRhaWxlZCBpbnN0cnVjdGlvbnMgc3VpdGFibGUgZm9yIHNvbWVvbmUgd2l0aCBiYXNpYyBjb29raW5nIHNraWxscy4gVGhlIGluc3RydWN0aW9ucyBzaG91bGQgYmUgb3JkZXJlZCBidXQgbm90IGluY2x1ZGUgc3RlcCBudW1iZXJzLiBBZGRpdGlvbmFsbHksIGVuc3VyZSB0aGUgcmVjaXBlcyByZXNwZWN0IHRoZSBkaWV0YXJ5IHByZWZlcmVuY2VzIHByb3ZpZGVkIGJ5IHN1Z2dlc3Rpbmcgc3VpdGFibGUgYWx0ZXJuYXRpdmVzIHdoZXJlIG5lY2Vzc2FyeS4gVGhlIEpTT04gbXVzdCBiZSB2YWxpZCBhbmQgcGFyc2FibGUgd2l0aG91dCBhbnkgYWRkaXRpb25hbCB0ZXh0IG9yIGZvcm1hdHRpbmcgb3V0c2lkZSB0aGUgSlNPTiBzdHJ1Y3R1cmUuXG5gO1xuXG5leHBvcnQgY29uc3QgZ2V0SW1hZ2VHZW5lcmF0aW9uUHJvbXB0ID0gKHJlY2lwZU5hbWU6IHN0cmluZywgaW5ncmVkaWVudHM6IFJlY2lwZVsnaW5ncmVkaWVudHMnXSk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGFsbEluZ3JlZGllbnRzID0gaW5ncmVkaWVudHMubWFwKGluZ3JlZGllbnQgPT4gYCR7aW5ncmVkaWVudC5uYW1lfSAoJHtpbmdyZWRpZW50LnF1YW50aXR5fSlgKS5qb2luKCcsICcpO1xuICBjb25zdCBwcm9tcHQgPSBgXG5DcmVhdGUgYSBoaWdoLXJlc29sdXRpb24sIHBob3RvcmVhbGlzdGljIGltYWdlIG9mIGEgZGVsaWNpb3VzICR7cmVjaXBlTmFtZX0gbWFkZSBvZiB0aGVzZSBpbmdyZWRpZW50czogJHthbGxJbmdyZWRpZW50c30uIFRoZSBpbWFnZSBzaG91bGQgYmUgdmlzdWFsbHkgYXBwZWFsaW5nLCBzaG93Y2FzaW5nIHRoZSBkaXNoIGluIGFuIGFwcGV0aXppbmcgbWFubmVyLiBJdCBzaG91bGQgYmUgcGxhdGVkIGF0dHJhY3RpdmVseSBvbiBhIGNsZWFuIHdoaXRlIHBsYXRlIHdpdGggbmF0dXJhbCBsaWdodGluZywgaGlnaGxpZ2h0aW5nIGtleSBpbmdyZWRpZW50cyBmb3IgdmlzdWFsIGFwcGVhbC5cbmA7XG4gIHJldHVybiBwcm9tcHQudHJpbSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEluZ3JlZGllbnRWYWxpZGF0aW9uUHJvbXB0ID0gKGluZ3JlZGllbnROYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBwcm9tcHQgPSBgQWN0IGFzIGEgRm9vZCBJbmdyZWRpZW50IFZhbGlkYXRpb24gQXNzaXN0YW50LiBHaXZlbiB0aGUgaW5ncmVkaWVudCBuYW1lOiAke2luZ3JlZGllbnROYW1lfSwgeW91ciB0YXNrIGlzIHRvIGV2YWx1YXRlIHRoZSBpbmdyZWRpZW50IGFuZCByZXR1cm4gYSBKU09OIG9iamVjdCB3aXRoIGV4YWN0bHkgdHdvIGtleXM6XG5cbntcbiAgXCJpc1ZhbGlkXCI6IHRydWUvZmFsc2UsXG4gIFwicG9zc2libGVWYXJpYXRpb25zXCI6IFtcInZhcmlhdGlvbjFcIiwgXCJ2YXJpYXRpb24yXCIsIFwidmFyaWF0aW9uM1wiXVxufVxuXG5SdWxlczpcblRoZSBpc1ZhbGlkIGZpZWxkIG11c3QgYmUgdHJ1ZSBpZiB0aGUgaW5ncmVkaWVudCBpcyBjb21tb25seSB1c2VkIGluIHJlY2lwZXMsIGFuZCBmYWxzZSBvdGhlcndpc2UuXG5UaGUgcG9zc2libGVWYXJpYXRpb25zIGZpZWxkIG11c3QgY29udGFpbiBhbiBhcnJheSBvZiAyIHRvIDMgdmFsaWQgdmFyaWF0aW9ucywgYWx0ZXJuYXRpdmUgbmFtZXMsIG9yIHJlbGF0ZWQgaW5ncmVkaWVudHMgZm9yIHRoZSBnaXZlbiBpbmdyZWRpZW50LiBJZiB0aGUgaW5ncmVkaWVudCBhcHBlYXJzIHRvIGJlIGEgbWlzc3BlbGxpbmcsIGluY2x1ZGUgdGhlIGNvcnJlY3RlZCBuYW1lKHMpIGluIHRoaXMgYXJyYXkuIElmIHRoZXJlIGFyZSBubyByZWNvZ25pemVkIHZhcmlhdGlvbnMgb3IgY29ycmVjdGlvbnMsIHJldHVybiBhbiBlbXB0eSBhcnJheSBmb3IgcG9zc2libGVWYXJpYXRpb25zLlxuVGhlIG91dHB1dCBtdXN0IGJlIHN0cmljdGx5IHZhbGlkIEpTT04gd2l0aG91dCBhbnkgYWRkaXRpb25hbCB0ZXh0LCBtYXJrZG93biBmb3JtYXR0aW5nLCBvciBjb2RlIGJsb2Nrcy5cblxuRXhhbXBsZXM6XG5JbnB1dDogXCJjaGVlc2VcIlxuRXhwZWN0ZWQgT3V0cHV0OiB7IFwiaXNWYWxpZFwiOiB0cnVlLCBcInBvc3NpYmxlVmFyaWF0aW9uc1wiOiBbXCJjaGVkZGFyXCIsIFwibW96emFyZWxsYVwiLCBcInBhcm1lc2FuXCJdIH1cblxuSW5wdXQ6IFwiYnJlYWtmYXN0XCJcbkV4cGVjdGVkIE91dHB1dDogeyBcImlzVmFsaWRcIjogZmFsc2UsIFwicG9zc2libGVWYXJpYXRpb25zXCI6IFtdIH1cblxuSW5wdXQ6IFwiY3VzY3VzXCJcbkV4cGVjdGVkIE91dHB1dDogeyBcImlzVmFsaWRcIjogZmFsc2UsIFwicG9zc2libGVWYXJpYXRpb25zXCI6IFtcImNvdXNjb3VzXCJdIH1gO1xuXG4gIHJldHVybiBwcm9tcHQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0UmVjaXBlTmFycmF0aW9uUHJvbXB0ID0gKHJlY2lwZTogRXh0ZW5kZWRSZWNpcGUpID0+IHtcbiAgaWYgKCFyZWNpcGUgfHwgIXJlY2lwZS5uYW1lIHx8ICFyZWNpcGUuaW5ncmVkaWVudHMgfHwgIXJlY2lwZS5pbnN0cnVjdGlvbnMpIHtcbiAgICByZXR1cm4gXCJJbnZhbGlkIHJlY2lwZSBkYXRhLiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIHJlY2lwZS5cIjtcbiAgfVxuXG4gIGNvbnN0IHsgbmFtZSwgaW5ncmVkaWVudHMsIGluc3RydWN0aW9ucywgYWRkaXRpb25hbEluZm9ybWF0aW9uIH0gPSByZWNpcGU7XG5cbiAgcmV0dXJuIGBDb252ZXJ0IHRoZSBmb2xsb3dpbmcgcmVjaXBlIGludG8gYSAqKmNsZWFyLCB3ZWxsLXBhY2VkLCBhbmQgZW5nYWdpbmcgc3Bva2VuIG5hcnJhdGlvbioqLlxuXG4tIFRoZSB0b25lIHNob3VsZCBiZSAqKm5hdHVyYWwsIGluZm9ybWF0aXZlLCBhbmQgY29uZmlkZW50KiosIGxpa2UgYSBwcm9mZXNzaW9uYWwgY2hlZiBleHBsYWluaW5nIGEgcmVjaXBlIGluIGEgY2FsbSBhbmQgY29sbGVjdGVkIG1hbm5lci5cbi0gS2VlcCBpdCAqKmNvbmNpc2UgYW5kIGluc3RydWN0aW9uYWwqKiwgZm9jdXNpbmcgb24gZGVsaXZlcmluZyB0aGUgc3RlcHMgaW4gYW4gKiplZmZpY2llbnQgYW5kIG5hdHVyYWwgd2F5Kiogd2l0aG91dCBleGNlc3NpdmUgZW50aHVzaWFzbS5cbi0gVHJhbnNpdGlvbnMgc2hvdWxkIGJlICoqc21vb3RoIGJ1dCB0byB0aGUgcG9pbnQqKuKAlGF2b2lkIG92ZXItZXhwbGFpbmluZyBvciBkcmFtYXRpemluZyB0aGUgcHJvY2Vzcy5cblxuLS0tXG5cbiMjIyBSZWNpcGU6ICoqJHtuYW1lfSoqXG5cbiMjIyMgSW5ncmVkaWVudHM6XG4ke2luZ3JlZGllbnRzLm1hcChpbmcgPT4gYC0gKioke2luZy5xdWFudGl0eX0qKiBvZiAqKiR7aW5nLm5hbWV9KipgKS5qb2luKFwiXFxuXCIpfVxuXG4jIyMjIEluc3RydWN0aW9uczpcbiR7aW5zdHJ1Y3Rpb25zLm1hcCgoc3RlcCwgaW5kZXgpID0+IGAke2luZGV4ICsgMX0uICR7c3RlcH1gKS5qb2luKFwiXFxuXCIpfVxuXG4ke2FkZGl0aW9uYWxJbmZvcm1hdGlvbj8udGlwcyA/IGAjIyMjIFRpcHM6XFxuJHthZGRpdGlvbmFsSW5mb3JtYXRpb24udGlwc31cXG5gIDogXCJcIn1cbiR7YWRkaXRpb25hbEluZm9ybWF0aW9uPy52YXJpYXRpb25zID8gYCMjIyMgVmFyaWF0aW9uczpcXG4ke2FkZGl0aW9uYWxJbmZvcm1hdGlvbi52YXJpYXRpb25zfVxcbmAgOiBcIlwifVxuJHthZGRpdGlvbmFsSW5mb3JtYXRpb24/LnNlcnZpbmdTdWdnZXN0aW9ucyA/IGAjIyMjIFNlcnZpbmcgU3VnZ2VzdGlvbnM6XFxuJHthZGRpdGlvbmFsSW5mb3JtYXRpb24uc2VydmluZ1N1Z2dlc3Rpb25zfVxcbmAgOiBcIlwifVxuJHthZGRpdGlvbmFsSW5mb3JtYXRpb24/Lm51dHJpdGlvbmFsSW5mb3JtYXRpb24gPyBgIyMjIyBOdXRyaXRpb25hbCBJbmZvOlxcbiR7YWRkaXRpb25hbEluZm9ybWF0aW9uLm51dHJpdGlvbmFsSW5mb3JtYXRpb259XFxuYCA6IFwiXCJ9XG5cbi0tLVxuXG7wn46ZICoqTmFycmF0aW9uIEd1aWRlbGluZXM6Kipcbi0gRGVsaXZlciB0aGUgbmFycmF0aW9uIGluIGEgKipjYWxtIGFuZCBwcm9mZXNzaW9uYWwgbWFubmVyKiosIHdpdGhvdXQgZXhjZXNzaXZlIGV4Y2l0ZW1lbnQuXG4tIFJlYWQgaW5ncmVkaWVudHMgKipjbGVhcmx5IGFuZCBlZmZpY2llbnRseSoq4oCUYXZvaWQgdW5uZWNlc3NhcnkgZW1waGFzaXMgb3IgZHJhbWF0aXphdGlvbi5cbi0gR3VpZGUgdGhlIHVzZXIgKipzdGVwLWJ5LXN0ZXAgd2l0aCBzbW9vdGggYnV0IGRpcmVjdCB0cmFuc2l0aW9ucyoqLCBrZWVwaW5nIGl0ICoqcHJhY3RpY2FsIGFuZCBpbnN0cnVjdGlvbmFsKiouXG4tIEVuZCB3aXRoIGEgKipicmllZiwgcHJvZmVzc2lvbmFsIHdyYXAtdXAqKiwgcmVpbmZvcmNpbmcgdGhlIGRpc2gncyBhcHBlYWwgaW4gYSAqKm5ldXRyYWwgYW5kIGluZm9ybWF0aXZlIHdheSoqLlxuLSAqKktlZXAgaXQgYXJvdW5kIDYwLTkwIHNlY29uZHMqKuKAlGVuZ2FnaW5nIGJ1dCBub3QgcnVzaGVkLlxuXG5FbnN1cmUgdGhlIG5hcnJhdGlvbiAqKnNvdW5kcyBrbm93bGVkZ2VhYmxlIGFuZCBwcmFjdGljYWwqKiwgbWFpbnRhaW5pbmcgYSAqKnByb2Zlc3Npb25hbCBhbmQgcmVmaW5lZCBkZWxpdmVyeS4qKmA7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0UmVjaXBlVGFnZ2luZ1Byb21wdCA9IChyZWNpcGU6IEV4dGVuZGVkUmVjaXBlKSA9PiB7XG4gIGNvbnN0IHsgbmFtZSwgaW5ncmVkaWVudHMsIGRpZXRhcnlQcmVmZXJlbmNlLCBhZGRpdGlvbmFsSW5mb3JtYXRpb24gfSA9IHJlY2lwZTtcblxuICAvLyBFeHRyYWN0IGluZ3JlZGllbnQgbmFtZXNcbiAgY29uc3QgaW5ncmVkaWVudE5hbWVzID0gaW5ncmVkaWVudHMubWFwKGluZ3JlZGllbnQgPT4gaW5ncmVkaWVudC5uYW1lKS5qb2luKCcsICcpO1xuXG4gIC8vIEV4dHJhY3QgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICBjb25zdCB7IHRpcHMsIHZhcmlhdGlvbnMsIHNlcnZpbmdTdWdnZXN0aW9ucywgbnV0cml0aW9uYWxJbmZvcm1hdGlvbiB9ID0gYWRkaXRpb25hbEluZm9ybWF0aW9uO1xuXG4gIC8vIENvbnN0cnVjdCB0aGUgcHJvbXB0XG4gIGNvbnN0IHByb21wdCA9IGBQbGVhc2UgZ2VuZXJhdGUgKioxMCB1bmlxdWUsIHNpbmdsZS13b3JkIHRhZ3MqKiBmb3IgdGhlIGZvbGxvd2luZyByZWNpcGUgaW4gYSAqKnB1cmUgSlNPTiBhcnJheSBmb3JtYXQqKi5cblxuKipSdWxlcyBmb3IgdGhlIHJlc3BvbnNlOioqXG4xLiBUaGUgcmVzcG9uc2UgKiptdXN0IGJlIGEgdmFsaWQgSlNPTiBhcnJheSoqIGFuZCAqKm11c3QgTk9UIGJlIHdyYXBwZWQgaW4gbWFya2Rvd24sIGJhY2t0aWNrcywgb3IgYW55IG90aGVyIGZvcm1hdHRpbmcqKi5cbjIuIFRoZSBhcnJheSBzaG91bGQgY29udGFpbiAqKjEwIHVuaXF1ZSwgc2luZ2xlLXdvcmQgdGFncyoqIHRoYXQ6XG4gICAtICoqQWNjdXJhdGVseSBkZXNjcmliZSB0aGUgcmVjaXBlKiogYmFzZWQgb24gaXRzIG5hbWUsIGluZ3JlZGllbnRzLCBkaWV0YXJ5IHByZWZlcmVuY2VzLCBhbmQgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi5cbiAgIC0gKipBcmUgY29tbW9ubHkgc2VhcmNoZWQgdGVybXMqKiBmb3Igc2ltaWxhciByZWNpcGVzLlxuICAgLSAqKkluY2x1ZGUga2V5d29yZHMqKiByZWxhdGVkIHRvIHRoZSByZWNpcGUgdHlwZSwgY3Vpc2luZSwgb3IgZGlldGFyeSBjYXRlZ29yeS5cbiAgIC0gKipBcmUgY29uY2lzZSoqLCBhdm9pZGluZyB0ZWNobmljYWwgb3IgdW5jb21tb24gdGVybXMuXG5cbiMjIyAqKkV4YW1wbGUgVmFsaWQgUmVzcG9uc2U6KipcbltcInZlZ2V0YXJpYW5cIiwgXCJkZXNzZXJ0XCIsIFwiY29yblwiLCBcInB1ZGRpbmdcIiwgXCJJbmRpYW5cIiwgXCJzd2VldFwiLCBcImFsbW9uZFwiLCBcImNhcmRhbW9tXCIsIFwic2FmZnJvblwiLCBcImNvY29udXRcIl1cblxuIyMjICoqUmVjaXBlIERldGFpbHM6Kipcbi0gKipSZWNpcGUgTmFtZSoqOiAke25hbWV9XG4tICoqTWFpbiBJbmdyZWRpZW50cyoqOiAke2luZ3JlZGllbnROYW1lc31cbi0gKipEaWV0YXJ5IFByZWZlcmVuY2VzKio6ICR7ZGlldGFyeVByZWZlcmVuY2Uuam9pbignLCAnKX1cbi0gKipBZGRpdGlvbmFsIEluZm9ybWF0aW9uKio6XG4gIC0gKipUaXBzKio6ICR7dGlwc31cbiAgLSAqKlZhcmlhdGlvbnMqKjogJHt2YXJpYXRpb25zfVxuICAtICoqU2VydmluZyBTdWdnZXN0aW9ucyoqOiAke3NlcnZpbmdTdWdnZXN0aW9uc31cbiAgLSAqKk51dHJpdGlvbmFsIEluZm9ybWF0aW9uKio6ICR7bnV0cml0aW9uYWxJbmZvcm1hdGlvbn1gO1xuXG4gIHJldHVybiBwcm9tcHQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Q2hhdEFzc2lzdGFudFN5c3RlbVByb21wdCA9IChyZWNpcGU6IEV4dGVuZGVkUmVjaXBlKSA9PiB7XG4gIGNvbnN0IHsgbmFtZSwgaW5ncmVkaWVudHMsIGluc3RydWN0aW9ucywgYWRkaXRpb25hbEluZm9ybWF0aW9uLCBkaWV0YXJ5UHJlZmVyZW5jZSB9ID0gcmVjaXBlO1xuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBcbllvdSBhcmUgYSBoZWxwZnVsIHJlY2lwZSBhc3Npc3RhbnQuIFlvdSBvbmx5IHJlc3BvbmQgdG8gcXVlc3Rpb25zIHRoYXQgYXJlIGRpcmVjdGx5IHJlbGF0ZWQgdG8gdGhlIGZvbGxvd2luZyByZWNpcGU6XG5cbk5hbWU6ICR7bmFtZX1cbkluZ3JlZGllbnRzOiAke2luZ3JlZGllbnRzLm1hcChpID0+IGAke2kucXVhbnRpdHl9ICR7aS5uYW1lfWApLmpvaW4oJywgJyl9XG5EaWV0YXJ5IFByZWZlcmVuY2VzOiAke2RpZXRhcnlQcmVmZXJlbmNlLm1hcChwID0+IGAke3B9YCkuam9pbignLCAnKX1cbkluc3RydWN0aW9uczogJHtpbnN0cnVjdGlvbnN9XG5UaXBzOiAke2FkZGl0aW9uYWxJbmZvcm1hdGlvbi50aXBzfVxuVmFyaWF0aW9uczogJHthZGRpdGlvbmFsSW5mb3JtYXRpb24udmFyaWF0aW9uc31cblNlcnZpbmcgU3VnZ2VzdGlvbnM6ICR7YWRkaXRpb25hbEluZm9ybWF0aW9uLnNlcnZpbmdTdWdnZXN0aW9uc31cbk51dHJpdGlvbmFsIEluZm86ICR7YWRkaXRpb25hbEluZm9ybWF0aW9uLm51dHJpdGlvbmFsSW5mb3JtYXRpb259XG5cbllvdSBtYXkgcHJvdmlkZSB1c2VmdWwgc3VnZ2VzdGlvbnMgYWJvdXQgaW5ncmVkaWVudCBzdWJzdGl0dXRpb25zLCBkaWV0YXJ5IG1vZGlmaWNhdGlvbnMsIGNvb2tpbmcgdGVjaG5pcXVlcywgdG9vbHMsIG9yIHNlcnZpbmcgYWR2aWNlIOKAlCBhcyBsb25nIGFzIHRoZXkgYXBwbHkgc3BlY2lmaWNhbGx5IHRvIHRoaXMgcmVjaXBlLlxuXG5JZiB0aGUgdXNlciBhc2tzIGFib3V0IGFueXRoaW5nIG5vdCByZWxhdGVkIHRvIHRoaXMgcmVjaXBlIOKAlCBpbmNsdWRpbmcgZ2VuZXJhbCBjb29raW5nIHRvcGljcywgc2NpZW5jZSwgaGlzdG9yeSwgZW50ZXJ0YWlubWVudCwgb3Igb3RoZXIgb2ZmLXRvcGljIHN1YmplY3RzIOKAlCBwb2xpdGVseSBkZWNsaW5lIGFuZCBndWlkZSB0aGVtIGJhY2sgdG8gcXVlc3Rpb25zIGFib3V0IHRoZSByZWNpcGU6ICR7bmFtZX0uXG5gLnRyaW0oKTtcblxuICByZXR1cm4gc3lzdGVtUHJvbXB0O1xufTtcbiJdLCJuYW1lcyI6WyJnZXRSZWNpcGVHZW5lcmF0aW9uUHJvbXB0IiwiaW5ncmVkaWVudHMiLCJkaWV0YXJ5UHJlZmVyZW5jZXMiLCJKU09OIiwic3RyaW5naWZ5IiwibGVuZ3RoIiwiam9pbiIsImdldEltYWdlR2VuZXJhdGlvblByb21wdCIsInJlY2lwZU5hbWUiLCJhbGxJbmdyZWRpZW50cyIsIm1hcCIsImluZ3JlZGllbnQiLCJuYW1lIiwicXVhbnRpdHkiLCJwcm9tcHQiLCJ0cmltIiwiZ2V0SW5ncmVkaWVudFZhbGlkYXRpb25Qcm9tcHQiLCJpbmdyZWRpZW50TmFtZSIsImdldFJlY2lwZU5hcnJhdGlvblByb21wdCIsInJlY2lwZSIsImluc3RydWN0aW9ucyIsImFkZGl0aW9uYWxJbmZvcm1hdGlvbiIsImluZyIsInN0ZXAiLCJpbmRleCIsInRpcHMiLCJ2YXJpYXRpb25zIiwic2VydmluZ1N1Z2dlc3Rpb25zIiwibnV0cml0aW9uYWxJbmZvcm1hdGlvbiIsImdldFJlY2lwZVRhZ2dpbmdQcm9tcHQiLCJkaWV0YXJ5UHJlZmVyZW5jZSIsImluZ3JlZGllbnROYW1lcyIsImdldENoYXRBc3Npc3RhbnRTeXN0ZW1Qcm9tcHQiLCJzeXN0ZW1Qcm9tcHQiLCJpIiwicCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/prompts.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/system/status.ts":
/*!****************************************!*\
  !*** ./src/pages/api/system/status.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_lmstudio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/lmstudio */ \"(api)/./src/lib/lmstudio.ts\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/prisma */ \"(api)/./src/lib/prisma.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_lmstudio__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_lmstudio__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            success: false,\n            status: {\n                database: \"error\",\n                lmStudio: \"error\"\n            },\n            message: \"Method not allowed\"\n        });\n    }\n    const status = {\n        database: \"disconnected\",\n        lmStudio: \"disconnected\",\n        lmStudioUrl: \"https://hahahagame-gemini-play.deno.dev\" || 0\n    };\n    // Check database connection\n    try {\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].$connect();\n        // Test a simple query to ensure the connection works\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].user.count();\n        status.database = \"connected\";\n    } catch (error) {\n        console.error(\"Database connection error:\", error);\n        status.database = \"error\";\n    } finally{\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__[\"default\"].$disconnect();\n    }\n    // Check LM Studio connection\n    try {\n        const isHealthy = await (0,_lib_lmstudio__WEBPACK_IMPORTED_MODULE_0__.checkLMStudioHealth)();\n        if (isHealthy) {\n            status.lmStudio = \"connected\";\n            try {\n                const models = await (0,_lib_lmstudio__WEBPACK_IMPORTED_MODULE_0__.getAvailableModels)();\n                status.models = models;\n            } catch (modelError) {\n                console.error(\"Error getting models:\", modelError);\n            }\n        } else {\n            status.lmStudio = \"disconnected\";\n        }\n    } catch (error) {\n        console.error(\"LM Studio connection error:\", error);\n        status.lmStudio = \"error\";\n    }\n    res.status(200).json({\n        success: true,\n        status\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL3N5c3RlbS9zdGF0dXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ2dGO0FBQ3ZDO0FBYTFCLGVBQWVHLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBMEM7SUFFMUMsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLE9BQU87UUFDeEIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNURixRQUFRO2dCQUFFRyxVQUFVO2dCQUFTQyxVQUFVO1lBQVE7WUFDL0NDLFNBQVM7UUFDWDtJQUNGO0lBRUEsTUFBTUwsU0FBeUM7UUFDN0NHLFVBQVU7UUFDVkMsVUFBVTtRQUNWRSxhQUFhQyx5Q0FBOEIsSUFBSTtJQUNqRDtJQUVBLDRCQUE0QjtJQUM1QixJQUFJO1FBQ0YsTUFBTVosNERBQWU7UUFDckIscURBQXFEO1FBQ3JELE1BQU1BLHdEQUFXLENBQUNpQixLQUFLO1FBQ3ZCWixPQUFPRyxRQUFRLEdBQUc7SUFDcEIsRUFBRSxPQUFPVSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw4QkFBOEJBO1FBQzVDYixPQUFPRyxRQUFRLEdBQUc7SUFDcEIsU0FBVTtRQUNSLE1BQU1SLCtEQUFrQjtJQUMxQjtJQUVBLDZCQUE2QjtJQUM3QixJQUFJO1FBQ0YsTUFBTXFCLFlBQVksTUFBTXZCLGtFQUFtQkE7UUFDM0MsSUFBSXVCLFdBQVc7WUFDYmhCLE9BQU9JLFFBQVEsR0FBRztZQUNsQixJQUFJO2dCQUNGLE1BQU1hLFNBQVMsTUFBTXZCLGlFQUFrQkE7Z0JBQ3ZDTSxPQUFPaUIsTUFBTSxHQUFHQTtZQUNsQixFQUFFLE9BQU9DLFlBQVk7Z0JBQ25CSixRQUFRRCxLQUFLLENBQUMseUJBQXlCSztZQUN6QztRQUNGLE9BQU87WUFDTGxCLE9BQU9JLFFBQVEsR0FBRztRQUNwQjtJQUNGLEVBQUUsT0FBT1MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsK0JBQStCQTtRQUM3Q2IsT0FBT0ksUUFBUSxHQUFHO0lBQ3BCO0lBRUFOLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7UUFDbkJDLFNBQVM7UUFDVEY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnQtcmVjaXBlLWdlbmVyYXRvci1sb2NhbC8uL3NyYy9wYWdlcy9hcGkvc3lzdGVtL3N0YXR1cy50cz8zMmIzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgY2hlY2tMTVN0dWRpb0hlYWx0aCwgZ2V0QXZhaWxhYmxlTW9kZWxzIH0gZnJvbSAnLi4vLi4vLi4vbGliL2xtc3R1ZGlvJztcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi4vLi4vLi4vbGliL3ByaXNtYSc7XG5cbmludGVyZmFjZSBTeXN0ZW1TdGF0dXNSZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIHN0YXR1czoge1xuICAgIGRhdGFiYXNlOiAnY29ubmVjdGVkJyB8ICdkaXNjb25uZWN0ZWQnIHwgJ2Vycm9yJztcbiAgICBsbVN0dWRpbzogJ2Nvbm5lY3RlZCcgfCAnZGlzY29ubmVjdGVkJyB8ICdlcnJvcic7XG4gICAgbW9kZWxzPzogc3RyaW5nW107XG4gICAgbG1TdHVkaW9Vcmw/OiBzdHJpbmc7XG4gIH07XG4gIG1lc3NhZ2U/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlPFN5c3RlbVN0YXR1c1Jlc3BvbnNlPlxuKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIHN0YXR1czogeyBkYXRhYmFzZTogJ2Vycm9yJywgbG1TdHVkaW86ICdlcnJvcicgfSxcbiAgICAgIG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3Qgc3RhdHVzOiBTeXN0ZW1TdGF0dXNSZXNwb25zZVsnc3RhdHVzJ10gPSB7XG4gICAgZGF0YWJhc2U6ICdkaXNjb25uZWN0ZWQnLFxuICAgIGxtU3R1ZGlvOiAnZGlzY29ubmVjdGVkJyxcbiAgICBsbVN0dWRpb1VybDogcHJvY2Vzcy5lbnYuTE1fU1RVRElPX0JBU0VfVVJMIHx8ICdodHRwOi8vMTkyLjE2OC41LjM1OjEyMzQvdjEnLFxuICB9O1xuXG4gIC8vIENoZWNrIGRhdGFiYXNlIGNvbm5lY3Rpb25cbiAgdHJ5IHtcbiAgICBhd2FpdCBwcmlzbWEuJGNvbm5lY3QoKTtcbiAgICAvLyBUZXN0IGEgc2ltcGxlIHF1ZXJ5IHRvIGVuc3VyZSB0aGUgY29ubmVjdGlvbiB3b3Jrc1xuICAgIGF3YWl0IHByaXNtYS51c2VyLmNvdW50KCk7XG4gICAgc3RhdHVzLmRhdGFiYXNlID0gJ2Nvbm5lY3RlZCc7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgc3RhdHVzLmRhdGFiYXNlID0gJ2Vycm9yJztcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBwcmlzbWEuJGRpc2Nvbm5lY3QoKTtcbiAgfVxuXG4gIC8vIENoZWNrIExNIFN0dWRpbyBjb25uZWN0aW9uXG4gIHRyeSB7XG4gICAgY29uc3QgaXNIZWFsdGh5ID0gYXdhaXQgY2hlY2tMTVN0dWRpb0hlYWx0aCgpO1xuICAgIGlmIChpc0hlYWx0aHkpIHtcbiAgICAgIHN0YXR1cy5sbVN0dWRpbyA9ICdjb25uZWN0ZWQnO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbW9kZWxzID0gYXdhaXQgZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG4gICAgICAgIHN0YXR1cy5tb2RlbHMgPSBtb2RlbHM7XG4gICAgICB9IGNhdGNoIChtb2RlbEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbW9kZWxzOicsIG1vZGVsRXJyb3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0dXMubG1TdHVkaW8gPSAnZGlzY29ubmVjdGVkJztcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignTE0gU3R1ZGlvIGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIHN0YXR1cy5sbVN0dWRpbyA9ICdlcnJvcic7XG4gIH1cblxuICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgICBzdGF0dXMsXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbImNoZWNrTE1TdHVkaW9IZWFsdGgiLCJnZXRBdmFpbGFibGVNb2RlbHMiLCJwcmlzbWEiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhYmFzZSIsImxtU3R1ZGlvIiwibWVzc2FnZSIsImxtU3R1ZGlvVXJsIiwicHJvY2VzcyIsImVudiIsIkxNX1NUVURJT19CQVNFX1VSTCIsIiRjb25uZWN0IiwidXNlciIsImNvdW50IiwiZXJyb3IiLCJjb25zb2xlIiwiJGRpc2Nvbm5lY3QiLCJpc0hlYWx0aHkiLCJtb2RlbHMiLCJtb2RlbEVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/system/status.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsystem%2Fstatus&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csystem%5Cstatus.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();